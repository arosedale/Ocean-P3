<!-- Load D3.js and other dependencies -->
<script src="https://d3js.org/d3.v7.min.js"></script>
<script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<!-- Fallback checks -->
<script>
window.addEventListener('load', function() {
  if (!window.d3) {
    document.getElementById('map').innerHTML = `
      <div class="error">
        <h3>Critical Library Missing</h3>
        <p>D3.js failed to load. This visualization requires D3.js to work.</p>
        <button onclick="window.location.reload()">Try Again</button>
        <p>If this persists, please check your internet connection.</p>
      </div>
    `;
  }
});
</script>
